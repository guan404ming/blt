# BLT Synthesizer Examples

This directory contains examples demonstrating the BLT synthesizer components.

## Example 1: Vocal Separation (âœ… Ready to run)

**File:** `separate_vocals.py`

Separates vocals and instrumental from an audio file using Demucs.

### Run:
```bash
python examples/separate_vocals.py
```

### Output:
```
examples/separated_audio/
â”œâ”€â”€ æ“±æ·º_vocals.wav       (5.8 MB - extracted vocals)
â””â”€â”€ æ“±æ·º_instrumental.wav (5.8 MB - instrumental background)
```

### Features:
- âœ… No external dependencies needed
- âœ… Handles torchaudio/torchcodec issues automatically
- âœ… Direct output in same folder (no nested directories)

---

## Example 2: Wav2Lip Lip-Sync Video (ğŸ”§ Requires setup)

**File:** `generate_lipsync.py`

Generates lip-synced videos using the separated vocals.

### Requirements:

1. **Face Video File**
   - Provide a video file with a person's face
   - Place at: `examples/face_video.mp4`
   - Format: MP4, AVI, MOV, etc.

2. **Wav2Lip Checkpoint**
   - Download from: https://github.com/Rudrabha/Wav2Lip
   - File: `wav2lip_gan.pth` (346 MB)
   - Place at: `examples/wav2lip_gan.pth`

3. **Separated Audio** (from Example 1)
   - Run `separate_vocals.py` first

### Run:
```bash
python examples/generate_lipsync.py
```

### Output:
```
examples/lipsync_output/
â””â”€â”€ æ“±æ·º_lipsync.mp4 (lip-synced video)
```

### Setup Steps:

```bash
# 1. Separate vocals from original song
python examples/separate_vocals.py

# 2. Download Wav2Lip checkpoint
cd examples
wget "https://github.com/Rudrabha/Wav2Lip/releases/download/v0.1/wav2lip_gan.pth"

# 3. Provide your face video
cp /path/to/your/video.mp4 examples/face_video.mp4

# 4. Generate lip-sync video
python examples/generate_lipsync.py
```

---

## Example 3: Whisper Lyrics Alignment (ğŸ“ Coming soon)

Aligns lyrics with audio using Stable Whisper for word-level timing.

```python
from blt.synthesizer import WhisperLyricsAligner

aligner = WhisperLyricsAligner(model_size="medium")
timings = aligner.align(
    audio_path="examples/separated_audio/æ“±æ·º_vocals.wav",
    lyrics="Your lyrics here..."
)
```

---

## Complete Pipeline Example

**File:** `complete_pipeline.py`

The unified end-to-end pipeline that includes all features:

```bash
python examples/complete_pipeline.py
```

This will:
1. Separate vocals and instrumental (Demucs)
2. Mix the audio tracks
3. Generate lip-sync video (Wav2Lip with FFmpeg fallback)
4. Create final video with audio

### Output:
```
examples/final_output/
â”œâ”€â”€ separated/
â”‚   â”œâ”€â”€ æ“±æ·º_vocals.wav
â”‚   â””â”€â”€ æ“±æ·º_instrumental.wav
â”œâ”€â”€ mixed_audio.wav
â”œâ”€â”€ lipsync_video.mp4
â””â”€â”€ æ“±æ·º_FINAL.mp4 â­
```

---

## File Structure

```
examples/
â”œâ”€â”€ æ“±æ·º.mp3                    # Original song
â”œâ”€â”€ face_video.mp4             # Your face video (add this)
â”œâ”€â”€ wav2lip_gan.pth            # Wav2Lip checkpoint (download)
â”œâ”€â”€ separated_audio/           # Generated by separate_vocals.py
â”‚   â”œâ”€â”€ æ“±æ·º_vocals.wav
â”‚   â””â”€â”€ æ“±æ·º_instrumental.wav
â”œâ”€â”€ lipsync_output/            # Generated by generate_lipsync.py
â”‚   â””â”€â”€ æ“±æ·º_lipsync.mp4
â”œâ”€â”€ README.md                  # This file
â”œâ”€â”€ separate_vocals.py         # Vocal separation example
â””â”€â”€ generate_lipsync.py        # Lip-sync video generation example
```

---

## Troubleshooting

### Vocal Separation Issues

**Error:** `Demucs failed`
- Make sure `demucs` is installed: `uv sync`
- Check input audio format is supported (MP3, WAV, etc.)

### Wav2Lip Issues

**Error:** `Output video was not created`
- Verify checkpoint file exists and is valid
- Check face video format and resolution
- Ensure audio duration matches video duration

**Error:** `FileNotFoundError: Checkpoint not found`
- Download checkpoint: https://github.com/Rudrabha/Wav2Lip
- Place in `examples/` directory

---

## Tips

- **Vocal Separation:** Works best with mixed stereo audio
- **Lip-Sync:** Higher quality with clear face visibility
- **Audio Alignment:** Works with English, Chinese, Spanish, etc.
- **Video Quality:** MP4 with H.264 codec recommended

---

## Next Steps

1. âœ… Run vocal separation
2. ğŸ”§ Set up Wav2Lip (download checkpoint + provide video)
3. ğŸ¬ Generate lip-sync video
4. ğŸ“ Add lyrics alignment
5. ğŸµ Create final karaoke video

Enjoy! ğŸ‰
